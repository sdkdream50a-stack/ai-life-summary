<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- SEO Meta Tags -->
  <title>AI 소울 타입 커뮤니티 - 같은 타입 사용자들과 소통하기 | AI Test Lab</title>
  <meta name="description" content="당신과 같은 소울 타입의 사람들과 이야기하세요. 플레임 폭스, 다이아몬드 라이온 등 12가지 소울 타입별 커뮤니티에서 경험을 공유해보세요.">
  <meta name="keywords" content="AI 소울 타입, 성격 커뮤니티, 소울 타입 게시판, AI 테스트 커뮤니티, 성격 유형 소통">
  <link rel="canonical" href="https://smartaitest.com/community/">

  <!-- Open Graph -->
  <meta property="og:title" content="AI 소울 타입 커뮤니티 - 같은 타입과 소통하기">
  <meta property="og:description" content="12가지 소울 타입별 커뮤니티에서 비슷한 성격의 사람들과 이야기해보세요!">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://smartaitest.com/community/">
  <meta property="og:image" content="https://smartaitest.com/images/community-og.png">
  <meta property="og:locale" content="ko_KR">
  <meta property="og:site_name" content="AI Test Lab">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="AI 소울 타입 커뮤니티">
  <meta name="twitter:description" content="같은 소울 타입의 사람들과 소통해보세요!">
  <meta name="twitter:image" content="https://smartaitest.com/images/community-og.png">

  <!-- Alternate Languages -->
  <link rel="alternate" hreflang="ko" href="https://smartaitest.com/community/">
  <link rel="alternate" hreflang="en" href="https://smartaitest.com/community/?lang=en">
  <link rel="alternate" hreflang="x-default" href="https://smartaitest.com/community/">

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Pretendard Font -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretendard@latest/dist/web/variable/pretendardvariable-dynamic-subset.min.css">

  <!-- Styles -->
  <link rel="stylesheet" href="../css/community.css">
  <link rel="stylesheet" href="../css/gamification.css">
  <link rel="stylesheet" href="../css/popups.css">

  <style>
    body {
      font-family: 'Pretendard Variable', Pretendard, -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif;
    }
  </style>

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "AI 소울 타입 커뮤니티",
    "description": "12가지 AI 소울 타입별 커뮤니티에서 같은 성격의 사람들과 소통하세요",
    "url": "https://smartaitest.com/community/",
    "isPartOf": {
      "@type": "WebSite",
      "name": "AI Test Lab",
      "url": "https://smartaitest.com"
    }
  }
  </script>
</head>
<body class="community-container">
  <!-- Header -->
  <header class="community-header">
    <a href="../" class="back-link" aria-label="Back to home">
      <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
      </svg>
    </a>
    <h1 class="header-title" data-i18n="community">Community</h1>
    <div class="header-actions">
      <a href="../profile/" class="header-btn" aria-label="Profile">
        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
        </svg>
      </a>
    </div>
  </header>

  <!-- Filter Tabs -->
  <div class="filter-tabs-container">
    <div class="filter-tabs">
      <button class="filter-tab active" data-filter="all" data-i18n="all">All</button>
      <button class="filter-tab" data-filter="flame-fox">
        <span class="tab-emoji"></span>
        <span data-i18n="flameFox">Flame Fox</span>
      </button>
      <button class="filter-tab" data-filter="diamond-lion">
        <span class="tab-emoji"></span>
        <span data-i18n="diamondLion">Diamond Lion</span>
      </button>
      <button class="filter-tab" data-filter="ocean-bear">
        <span class="tab-emoji"></span>
        <span data-i18n="oceanBear">Ocean Bear</span>
      </button>
      <button class="filter-tab" data-filter="crystal-butterfly">
        <span class="tab-emoji"></span>
        <span data-i18n="crystalButterfly">Crystal Butterfly</span>
      </button>
      <button class="filter-tab" data-filter="storm-eagle">
        <span class="tab-emoji"></span>
        <span data-i18n="stormEagle">Storm Eagle</span>
      </button>
      <button class="filter-tab" data-filter="moonlit-wolf">
        <span class="tab-emoji"></span>
        <span data-i18n="moonlitWolf">Moonlit Wolf</span>
      </button>
      <button class="filter-tab" data-filter="golden-phoenix">
        <span class="tab-emoji"></span>
        <span data-i18n="goldenPhoenix">Golden Phoenix</span>
      </button>
      <button class="filter-tab" data-filter="jade-turtle">
        <span class="tab-emoji"></span>
        <span data-i18n="jadeTurtle">Jade Turtle</span>
      </button>
      <button class="filter-tab" data-filter="silver-swan">
        <span class="tab-emoji"></span>
        <span data-i18n="silverSwan">Silver Swan</span>
      </button>
      <button class="filter-tab" data-filter="cosmic-owl">
        <span class="tab-emoji"></span>
        <span data-i18n="cosmicOwl">Cosmic Owl</span>
      </button>
      <button class="filter-tab" data-filter="rainbow-dolphin">
        <span class="tab-emoji"></span>
        <span data-i18n="rainbowDolphin">Rainbow Dolphin</span>
      </button>
      <button class="filter-tab" data-filter="shadow-panther">
        <span class="tab-emoji"></span>
        <span data-i18n="shadowPanther">Shadow Panther</span>
      </button>
    </div>
  </div>

  <!-- Main Content -->
  <main class="community-feed">
    <div id="community-posts">
      <!-- Posts will be rendered by JS -->
    </div>

    <div id="load-more-trigger" class="load-more-trigger">
      <div class="load-more-spinner"></div>
    </div>
  </main>

  <!-- Write Post FAB -->
  <button id="write-post-fab" class="write-post-fab" aria-label="Write post">
    <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
    </svg>
  </button>

  <!-- Write Post Modal -->
  <div id="write-modal-overlay" class="write-modal-overlay">
    <div class="write-modal">
      <div class="write-modal-header">
        <h2 class="write-modal-title" data-i18n="writePost">Write Post</h2>
        <button id="write-modal-close" class="write-modal-close" aria-label="Close">&times;</button>
      </div>

      <div class="write-modal-body">
        <textarea
          id="write-textarea"
          class="write-textarea"
          placeholder="무슨 생각을 하고 계세요?"
          maxlength="500"
        ></textarea>
        <div id="write-char-count" class="write-char-count">0/500</div>

        <div id="attachment-section" class="write-attachment-section" style="display: none;">
          <span class="write-attachment-label" data-i18n="attachResult">Attach test result</span>
          <div class="attachment-options">
            <button class="attachment-option" data-type="life-summary">
              <span></span>
              <span data-i18n="lifeSummary">Life Summary</span>
            </button>
            <button class="attachment-option" data-type="compatibility">
              <span></span>
              <span data-i18n="compatibility">Compatibility</span>
            </button>
          </div>
          <div id="selected-attachment" class="selected-attachment" style="display: none;">
            <span class="selected-attachment-emoji"></span>
            <div class="selected-attachment-info">
              <span class="selected-attachment-name"></span>
            </div>
            <button id="remove-attachment" class="selected-attachment-remove">&times;</button>
          </div>
        </div>
      </div>

      <div class="write-modal-footer">
        <button id="write-submit-btn" class="write-submit-btn" disabled data-i18n="post">Post</button>
      </div>
    </div>
  </div>

  <!-- Navigation -->
  <nav class="community-nav">
    <a href="../" class="nav-link">
      <span class="nav-icon"></span>
      <span data-i18n="home">Home</span>
    </a>
    <a href="../daily/" class="nav-link">
      <span class="nav-icon"></span>
      <span data-i18n="daily">Daily</span>
    </a>
    <a href="#" class="nav-link active">
      <span class="nav-icon"></span>
      <span data-i18n="community">Community</span>
    </a>
    <a href="../ranking/" class="nav-link">
      <span class="nav-icon"></span>
      <span data-i18n="ranking">Ranking</span>
    </a>
    <a href="../profile/" class="nav-link">
      <span class="nav-icon"></span>
      <span data-i18n="profile">Profile</span>
    </a>
  </nav>

  <!-- Scripts -->
  <script src="../js/soul-types.js"></script>
  <script src="../js/user-data.js"></script>
  <script src="../js/badges.js"></script>
  <script src="../js/level-xp.js"></script>
  <script src="../js/gamification-ui.js"></script>
  <script src="../js/community-data.js"></script>
  <script src="../js/community-feed.js"></script>

  <script>
    // i18n translations
    const i18n = {
      ko: {
        community: '커뮤니티',
        all: '전체',
        flameFox: '플레임 폭스',
        diamondLion: '다이아몬드 라이온',
        oceanBear: '오션 베어',
        crystalButterfly: '크리스탈 버터플라이',
        stormEagle: '스톰 이글',
        moonlitWolf: '문릿 울프',
        goldenPhoenix: '골든 피닉스',
        jadeTurtle: '제이드 터틀',
        silverSwan: '실버 스완',
        cosmicOwl: '코스믹 아울',
        rainbowDolphin: '레인보우 돌핀',
        shadowPanther: '섀도우 팬서',
        writePost: '글 쓰기',
        attachResult: '테스트 결과 첨부',
        lifeSummary: '인생 요약',
        compatibility: '궁합',
        post: '게시하기',
        home: '홈',
        daily: '일일',
        ranking: '랭킹',
        profile: '프로필',
        placeholder: '무슨 생각을 하고 계세요?'
      },
      en: {
        community: 'Community',
        all: 'All',
        flameFox: 'Flame Fox',
        diamondLion: 'Diamond Lion',
        oceanBear: 'Ocean Bear',
        crystalButterfly: 'Crystal Butterfly',
        stormEagle: 'Storm Eagle',
        moonlitWolf: 'Moonlit Wolf',
        goldenPhoenix: 'Golden Phoenix',
        jadeTurtle: 'Jade Turtle',
        silverSwan: 'Silver Swan',
        cosmicOwl: 'Cosmic Owl',
        rainbowDolphin: 'Rainbow Dolphin',
        shadowPanther: 'Shadow Panther',
        writePost: 'Write Post',
        attachResult: 'Attach test result',
        lifeSummary: 'Life Summary',
        compatibility: 'Compatibility',
        post: 'Post',
        home: 'Home',
        daily: 'Daily',
        ranking: 'Ranking',
        profile: 'Profile',
        placeholder: "What's on your mind?"
      },
      ja: {
        community: 'コミュニティ',
        all: '全て',
        flameFox: 'フレイムフォックス',
        diamondLion: 'ダイヤモンドライオン',
        oceanBear: 'オーシャンベア',
        crystalButterfly: 'クリスタルバタフライ',
        stormEagle: 'ストームイーグル',
        moonlitWolf: 'ムーンリットウルフ',
        goldenPhoenix: 'ゴールデンフェニックス',
        jadeTurtle: 'ジェイドタートル',
        silverSwan: 'シルバースワン',
        cosmicOwl: 'コズミックアウル',
        rainbowDolphin: 'レインボードルフィン',
        shadowPanther: 'シャドウパンサー',
        writePost: '投稿する',
        attachResult: 'テスト結果を添付',
        lifeSummary: '人生要約',
        compatibility: '相性',
        post: '投稿',
        home: 'ホーム',
        daily: 'デイリー',
        ranking: 'ランキング',
        profile: 'プロフィール',
        placeholder: '何を考えていますか？'
      },
      zh: {
        community: '社区',
        all: '全部',
        flameFox: '烈焰狐',
        diamondLion: '钻石狮王',
        oceanBear: '海洋熊',
        crystalButterfly: '水晶蝴蝶',
        stormEagle: '风暴鹰',
        moonlitWolf: '月光狼',
        goldenPhoenix: '金凤凰',
        jadeTurtle: '翡翠龟',
        silverSwan: '银天鹅',
        cosmicOwl: '宇宙猫头鹰',
        rainbowDolphin: '彩虹海豚',
        shadowPanther: '暗影豹',
        writePost: '发帖',
        attachResult: '附加测试结果',
        lifeSummary: '人生总结',
        compatibility: '配对',
        post: '发布',
        home: '首页',
        daily: '每日',
        ranking: '排行',
        profile: '个人',
        placeholder: '你在想什么？'
      },
      es: {
        community: 'Comunidad',
        all: 'Todo',
        flameFox: 'Zorro de Fuego',
        diamondLion: 'León de Diamante',
        oceanBear: 'Oso del Océano',
        crystalButterfly: 'Mariposa de Cristal',
        stormEagle: 'Águila de Tormenta',
        moonlitWolf: 'Lobo de Luna',
        goldenPhoenix: 'Fénix Dorado',
        jadeTurtle: 'Tortuga de Jade',
        silverSwan: 'Cisne de Plata',
        cosmicOwl: 'Búho Cósmico',
        rainbowDolphin: 'Delfín Arcoíris',
        shadowPanther: 'Pantera de Sombra',
        writePost: 'Escribir',
        attachResult: 'Adjuntar resultado',
        lifeSummary: 'Resumen de Vida',
        compatibility: 'Compatibilidad',
        post: 'Publicar',
        home: 'Inicio',
        daily: 'Diario',
        ranking: 'Ranking',
        profile: 'Perfil',
        placeholder: '¿Qué estás pensando?'
      }
    };

    let currentLang = 'ko';

    // Detect language
    function detectLanguage() {
      const urlParams = new URLSearchParams(window.location.search);
      const langParam = urlParams.get('lang');
      if (langParam && i18n[langParam]) return langParam;

      const saved = localStorage.getItem('ai-life-summary-lang');
      if (saved && i18n[saved]) return saved;

      const browserLang = navigator.language.split('-')[0];
      return i18n[browserLang] ? browserLang : 'ko';
    }

    function t(key) {
      return (i18n[currentLang] && i18n[currentLang][key]) || i18n.en[key] || key;
    }

    function applyTranslations() {
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        el.textContent = t(key);
      });

      // Update placeholder
      const textarea = document.getElementById('write-textarea');
      if (textarea) {
        textarea.placeholder = t('placeholder');
      }

      // Update filter tabs with emojis
      updateFilterTabsWithEmojis();
    }

    function updateFilterTabsWithEmojis() {
      if (typeof SOUL_TYPES === 'undefined') return;

      document.querySelectorAll('.filter-tab[data-filter]').forEach(tab => {
        const filter = tab.dataset.filter;
        if (filter === 'all') return;

        const soulType = SOUL_TYPES.find(t => t.id === filter);
        if (soulType) {
          const emojiEl = tab.querySelector('.tab-emoji');
          if (emojiEl) {
            emojiEl.textContent = soulType.emoji.split('')[0];
          }

          const nameEl = tab.querySelector('[data-i18n]');
          if (nameEl) {
            const nameKey = `name${currentLang.charAt(0).toUpperCase()}${currentLang.slice(1)}`;
            nameEl.textContent = soulType[nameKey] || soulType.nameEn;
          }
        }
      });
    }

    // Initialize
    async function init() {
      currentLang = detectLanguage();
      applyTranslations();

      // Initialize user data
      if (typeof userDataManager !== 'undefined') {
        await userDataManager.initialize();
      }

      // Initialize gamification UI
      if (typeof gamificationUI !== 'undefined') {
        gamificationUI.initialize(currentLang);
      }

      // Initialize feed
      communityFeed.initialize(currentLang);
    }

    document.addEventListener('DOMContentLoaded', init);
  </script>

  <!-- Microsoft Clarity -->
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "CLARITY_ID");
  </script>
</body>
</html>
